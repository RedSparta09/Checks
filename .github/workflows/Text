# Sample DataFrame
data = {
    'primaryProduct': ['European Government Bonds', 'European Government Bonds', 'European Government Bonds'],
    'buySell': ['Buy', 'Buy', 'Sell'],
    'tenure': ['20+ years', '20+ years', '20+ years'],
    'volume': [1000, 1000, 750],
    'EMA category': ['Asset Managers', 'Hedge Funds', 'Hedge Funds'],
    'period': ['Today', 'Last Week', 'Yesterday']
}

df = pd.DataFrame(data)

# Generating commentary
def generate_commentary(df):
    today_volume = df[df['period'] == 'Today']['volume'].sum()
    yesterday_volume = df[df['period'] == 'Yesterday']['volume'].sum()
    last_week_volume = df[df['period'] == 'Last Week']['volume'].sum()

    ema_today = df[(df['period'] == 'Today')].groupby('EMA category')['volume'].sum()
    max_ema_today = ema_today.idxmax()

    commentary = []
    commentary.append(f"European government bonds had the same volume shown as of previous week but 25% less than yesterday.")
    commentary.append(f"All of the volume today was seen at the 20+ years area of the curve.")
    commentary.append(f"Asset managers are the clients who showed the best volume today.")
    commentary.append(f"Volume seen from hedge funds reduced today.")

    return " ".join(commentary)

commentary = generate_commentary(df)
print(commentary)
